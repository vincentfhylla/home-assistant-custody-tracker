type: vertical-stack
cards:

  # -------------------------------
  # LAST NIGHT RESULT
  # -------------------------------
  - type: entities
    title: üõèÔ∏è Last Night Result
    show_header_toggle: false
    entities:
      - entity: sensor.custody_final_night_with_date
        name: Final location (night of)
      - entity: input_text.custody_last_final_display_date
        name: Date (night of)
      - entity: input_select.custody_night_location_final
        name: Final location (editable)

  # -------------------------------
  # MANUAL NIGHT CORRECTION
  # -------------------------------
  - type: entities
    title: ‚úèÔ∏è Manual Night Correction
    show_header_toggle: false
    entities:
      - entity: input_boolean.custody_night_manual_override
        name: Manual override (ON = you control Final)
      - entity: input_boolean.custody_night_locked
        name: Night locked
      - entity: input_boolean.custody_night_counted
        name: Counted (prevents double count)
      - entity: input_select.custody_night_location_auto
        name: Auto-detected
      - entity: input_select.custody_night_location_final
        name: Final (set if needed)
      - entity: input_text.custody_other_reason
        name: Other reason (required if Other)

  # -------------------------------
  # TOTAL NIGHTS COMPARISON (YTD + MTD)
  # -------------------------------
  - type: grid
    title: üìä Total Nights Comparison
    columns: 2
    square: false
    cards:
      - type: entities
        title: Year-to-Date
        entities:
          - entity: counter.custody_nights_dad
            name: Dad
          - entity: counter.custody_nights_mom
            name: Mom
          - entity: counter.custody_nights_other
            name: Other
          - entity: sensor.custody_ytd_total_nights
            name: Total

      - type: entities
        title: Month-to-Date
        entities:
          - entity: counter.custody_nights_dad_mtd
            name: Dad (MTD)
          - entity: counter.custody_nights_mom_mtd
            name: Mom (MTD)
          - entity: counter.custody_nights_other_mtd
            name: Other (MTD)
          - entity: sensor.custody_mtd_total_nights
            name: Total (MTD)

  # -------------------------------
  # SCHEDULED VS ACTUAL (MTD)
  # -------------------------------
  - type: entities
    title: üìà Scheduled vs Actual (MTD)
    entities:
      - entity: sensor.custody_expected_dad_nights_mtd
        name: Expected Dad nights (MTD)
      - entity: counter.custody_nights_dad_mtd
        name: Actual Dad nights (MTD)
      - entity: sensor.custody_dad_variance_mtd
        name: Dad variance (MTD)

  # -------------------------------
  # SCHEDULED VS ACTUAL (YTD)
  # -------------------------------
  - type: entities
    title: üìà Scheduled vs Actual (YTD)
    entities:
      - entity: sensor.custody_expected_dad_nights_ytd
        name: Expected Dad nights (YTD)
      - entity: counter.custody_nights_dad
        name: Actual Dad nights (YTD)
      - entity: sensor.custody_dad_variance_ytd
        name: Dad variance (YTD)

  # -------------------------------
  # CUSTODY PERCENTAGES (MTD + YTD)
  # -------------------------------
  - type: grid
    title: ‚öñÔ∏è Custody % (MTD + YTD)
    columns: 3
    square: false
    cards:
      - type: gauge
        name: Dad (MTD)
        entity: sensor.custody_dad_pct_mtd
        min: 0
        max: 100
        needle: true
      - type: gauge
        name: Mom (MTD)
        entity: sensor.custody_mom_pct_mtd
        min: 0
        max: 100
        needle: true
      - type: gauge
        name: Other (MTD)
        entity: sensor.custody_other_pct_mtd
        min: 0
        max: 100
        needle: true

  - type: grid
    title: ‚öñÔ∏è Custody % (YTD)
    columns: 3
    square: false
    cards:
      - type: gauge
        name: Dad (YTD)
        entity: sensor.custody_dad_pct_ytd
        min: 0
        max: 100
        needle: true
      - type: gauge
        name: Mom (YTD)
        entity: sensor.custody_mom_pct_ytd
        min: 0
        max: 100
        needle: true
      - type: gauge
        name: Other (YTD)
        entity: sensor.custody_other_pct_ytd
        min: 0
        max: 100
        needle: true

  # -------------------------------
  # 14 NIGHT HISTORY
  # -------------------------------
  - type: markdown
    title: üß± Last 14 Nights
    content: |
      {{ states('sensor.custody_history_14_icons') }}
